# План реализации CapsuleGraph v0.1

Этот документ фиксирует конкретные шаги по созданию CapsuleGraph. После конвертации исходной модели формируется файл `.cgraph` с полным CapsuleGraph. Из него автоматически строится MiniCapsuleGraph для быстрого вывода. Лёгкая модель держится в оперативной памяти и обращается к полному графу только при необходимости.

## Приоритеты
1. **Запуск прототипа** – конвертация моделей в `.cgraph` и выполнение MiniCapsuleGraph на CPU.
2. **Минимальные зависимости** – использовать готовые библиотеки (например, ONNX Runtime) для быстрого старта.
3. **Конкретная схема CapsuleGraph** – точное описание JSON/YAML‑структуры капсулы, версионирование и правила совместимости.
4. **Инструменты автоматизации** – скрипты конвертации, проверок и простой CLI.
5. **Тестирование и профилирование** – набор коротких тестов и измерение скорости вывода.

## Потенциальные ошибки и пути их решения
- **Несогласованность форматов** – в первых версиях допускаем только проверенные комбинации (gguf/onnx).
- **Недостаток RAM/VRAM** – предоставляем режим частичной загрузки весов и работу с миниграфом.
- **Неудачная оптимизация** – даём возможность откатить изменения, храним полные CapsuleGraph до трансформаций.

## Этапы реализации
### Этап 1. Подготовка
1. Базовая структура репозитория и конфигурация зависимостей.
2. Первичный скрипт преобразования gguf/onnx в `.cgraph`.
3. Прототип разделения файла на полный и мини-граф.

### Этап 2. Минимальный рантайм
1. Рантайм на Python для загрузки MiniCapsuleGraph.
2. Механизм обращения к полному CapsuleGraph при выводе.
3. Подготовка к последующей оптимизации (C++/CUDA).

### Этап 3. Инструменты
1. CLI `cgraph convert <файл>` – конвертация и разделение модели.
2. CLI `cgraph run <mini.cgraph>` – выполнение вывода.
3. Логирование и отчёты о производительности.

### Этап 4. Тестирование
1. Скрипты для проверки конвертации и вывода.
2. Тестовая модель небольшого размера для измерения скорости.

### Этап 5. Документация
1. Полное описание формата `.cgraph` и структуры капсулы.
2. Примеры использования CLI и рекомендации по расширению.

## Дополнительные шаги
- Плагины для аппаратных бэкэндов и оптимизаций.
- Сбор статистики использования (с согласия пользователей) для последующей доработки.

## Контрольные точки
- **v0.1-alpha** – работает конвертер и базовый рантайм, CLI выполняет основные команды.
- **v0.1-beta** – стабилизация и оптимизация производительности, добавлены тесты.
- **v0.1** – итоговый выпуск с документацией и возможностью расширения через плагины.

## Этап 6. CI/CD и контроль качества
1. Настройка тестов и сборок в GitHub Actions.
2. Отчёты о покрытии и статическом анализе кода.
3. Автоматическая генерация документации при каждом пуше.

## Этап 7. Поддержка расширений
1. Документированный API для плагинов.
2. Примеры кастомных капсул и бэкэндов.
3. Регистры плагинов с возможностью горячей загрузки.

## Этап 8. Сообщество и обратная связь
1. Создание Wiki и шаблонов issue.
2. Сбор предложений по оптимизации из практического опыта.
3. Подготовка Roadmap v0.2 на основе полученных данных.

Этот план описывает реальные шаги по созданию CapsuleGraph v0.1 и может служить основой для дальнейшего развития проекта.
